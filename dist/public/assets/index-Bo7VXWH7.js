import{r as n,j as e}from"./react-BcDEu0eg.js";import{c as Nt}from"./react-dom-B4wlCyuG.js";import{u as re,L as Ke,S as bt,R as te}from"./wouter-CSLFdEH9.js";import{Q as yt,u as E,a as be,b as Y,c as vt}from"./@tanstack-BkbJX2lW.js";import{V as ts,R as as,A as rs,C as ns,T as ls,D as is,P as wt,a as os,b as St,S as cs,c as ds,I as kt,d as ms,e as xs,f as Ct,g as us,h as Pt,L as ps,i as hs,j as Tt,k as At,l as fs,m as Lt,n as Rt,o as js,p as gs,q as Ns,r as bs,s as Dt,O as ys,t as Et,u as vs,v as It,w as ws,x as Ss,y as Ft,z as ks,B as Bt,E as Cs,F as $t,G as Ps,H as Ts,J as As,K as Ls}from"./@radix-ui-CTPcNPhy.js";import{c as Te}from"./class-variance-authority-Dp3B9jqt.js";import{c as Ot}from"./clsx-B-dksMZM.js";import{t as Mt}from"./tailwind-merge-D696Ktp4.js";import{X as Rs,C as _t,a as Ds,b as Ut,c as qt,T as Es,A as Vt,d as zt,L as ve,e as Kt}from"./lucide-react-DVWz8XLR.js";import{H as me}from"./react-helmet-D79DAlN-.js";import{u as Gt,F as Ht,C as Qt,b as Is}from"./react-hook-form-B9RC15E6.js";import{t as Fs}from"./@hookform-BGr8wshS.js";import{z as V}from"./zod-mSkvzYyn.js";import{c as xe}from"./drizzle-zod-BTmPMXAp.js";import{p as ue,t as ae,d as L,e as X,s as pe,j as Ne,f as Bs}from"./drizzle-orm-DVBOmP9y.js";import"./object-assign-ylVCi4cB.js";import"./scheduler-C323NY8X.js";import"./regexparam-CPXopyEH.js";import"./use-sync-external-store-90Tl0Lkp.js";import"./@floating-ui-DFEpnGD8.js";import"./aria-hidden-DQ5UC2Eg.js";import"./react-remove-scroll-49WNFpz8.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-NsO0SezE.js";import"./react-style-singleton-Cw-Qp3yQ.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-BYRcClZK.js";import"./use-callback-ref-BZCvRRZc.js";import"./prop-types-DqqsdRhC.js";import"./react-side-effect-BjRmNf3T.js";import"./react-fast-compare-DMFPdO1R.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const u of i)if(u.type==="childList")for(const o of u.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const u={};return i.integrity&&(u.integrity=i.integrity),i.referrerPolicy&&(u.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?u.credentials="include":i.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(i){if(i.ep)return;i.ep=!0;const u=t(i);fetch(i.href,u)}})();async function $s(s){if(!s.ok){const a=await s.text()||s.statusText;throw new Error(`${s.status}: ${a}`)}}async function B(s,a,t){const r=await fetch(a,{method:s,headers:t?{"Content-Type":"application/json"}:{},body:t?JSON.stringify(t):void 0,credentials:"include"});return await $s(r),r}const Yt=({on401:s})=>async({queryKey:a})=>{const t=await fetch(a[0],{credentials:"include"});return await $s(t),await t.json()},_e=new yt({defaultOptions:{queries:{queryFn:Yt({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),Jt=1,Wt=1e6;let Oe=0;function Xt(){return Oe=(Oe+1)%Number.MAX_SAFE_INTEGER,Oe.toString()}const Me=new Map,ss=s=>{if(Me.has(s))return;const a=setTimeout(()=>{Me.delete(s),ke({type:"REMOVE_TOAST",toastId:s})},Wt);Me.set(s,a)},Zt=(s,a)=>{switch(a.type){case"ADD_TOAST":return{...s,toasts:[a.toast,...s.toasts].slice(0,Jt)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(t=>t.id===a.toast.id?{...t,...a.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=a;return t?ss(t):s.toasts.forEach(r=>{ss(r.id)}),{...s,toasts:s.toasts.map(r=>r.id===t||t===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return a.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(t=>t.id!==a.toastId)}}},Re=[];let De={toasts:[]};function ke(s){De=Zt(De,s),Re.forEach(a=>{a(De)})}function ea({...s}){const a=Xt(),t=i=>ke({type:"UPDATE_TOAST",toast:{...i,id:a}}),r=()=>ke({type:"DISMISS_TOAST",toastId:a});return ke({type:"ADD_TOAST",toast:{...s,id:a,open:!0,onOpenChange:i=>{i||r()}}}),{id:a,dismiss:r,update:t}}function he(){const[s,a]=n.useState(De);return n.useEffect(()=>(Re.push(a),()=>{const t=Re.indexOf(a);t>-1&&Re.splice(t,1)}),[s]),{...s,toast:ea,dismiss:t=>ke({type:"DISMISS_TOAST",toastId:t})}}function d(...s){return Mt(Ot(s))}const sa=wt,Os=n.forwardRef(({className:s,...a},t)=>e.jsx(ts,{ref:t,className:d("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...a}));Os.displayName=ts.displayName;const ta=Te("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Ms=n.forwardRef(({className:s,variant:a,...t},r)=>e.jsx(as,{ref:r,className:d(ta({variant:a}),s),...t}));Ms.displayName=as.displayName;const aa=n.forwardRef(({className:s,...a},t)=>e.jsx(rs,{ref:t,className:d("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...a}));aa.displayName=rs.displayName;const _s=n.forwardRef(({className:s,...a},t)=>e.jsx(ns,{ref:t,className:d("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...a,children:e.jsx(Rs,{className:"h-4 w-4"})}));_s.displayName=ns.displayName;const Us=n.forwardRef(({className:s,...a},t)=>e.jsx(ls,{ref:t,className:d("text-sm font-semibold",s),...a}));Us.displayName=ls.displayName;const qs=n.forwardRef(({className:s,...a},t)=>e.jsx(is,{ref:t,className:d("text-sm opacity-90",s),...a}));qs.displayName=is.displayName;function ra(){const{toasts:s}=he();return e.jsxs(sa,{children:[s.map(function({id:a,title:t,description:r,action:i,...u}){return e.jsxs(Ms,{...u,children:[e.jsxs("div",{className:"grid gap-1",children:[t&&e.jsx(Us,{children:t}),r&&e.jsx(qs,{children:r})]}),i,e.jsx(_s,{})]},a)}),e.jsx(Os,{})]})}const na=St,la=n.forwardRef(({className:s,sideOffset:a=4,...t},r)=>e.jsx(os,{ref:r,sideOffset:a,className:d("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",s),...t}));la.displayName=os.displayName;const R=n.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:d("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a}));R.displayName="Card";const $=n.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:d("flex flex-col space-y-1.5 p-6",s),...a}));$.displayName="CardHeader";const O=n.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:d("text-2xl font-semibold leading-none tracking-tight",s),...a}));O.displayName="CardTitle";const Z=n.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:d("text-sm text-muted-foreground",s),...a}));Z.displayName="CardDescription";const D=n.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:d("p-6 pt-0",s),...a}));D.displayName="CardContent";const Ue=n.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:d("flex items-center p-6 pt-0",s),...a}));Ue.displayName="CardFooter";function ia(){return e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:e.jsx(R,{className:"w-full max-w-md mx-4",children:e.jsxs(D,{className:"pt-6",children:[e.jsxs("div",{className:"flex mb-4 gap-2",children:[e.jsx(_t,{className:"h-8 w-8 text-red-500"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),e.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}function ne(){const[s]=re(),a=[{name:"Dashboard",path:"/",icon:"home"},{name:"My Proposals",path:"/proposals",icon:"file-alt"},{name:"Templates",path:"/templates",icon:"folder-open"},{name:"Backup & Recovery",path:"/backup",icon:"history"},{name:"Settings",path:"/settings",icon:"cog"}];return e.jsxs("aside",{className:"hidden md:flex flex-col bg-white w-64 border-r border-neutral-200 shadow-sm h-screen",children:[e.jsxs("div",{className:"p-4 border-b border-neutral-200",children:[e.jsxs("h1",{className:"text-xl font-semibold text-primary flex items-center",children:[e.jsx("i",{className:"fas fa-file-contract mr-2"}),"ProposalCraft"]}),e.jsx("p",{className:"text-xs text-neutral-400 mt-1",children:"HR Proposal Generator"})]}),e.jsx("nav",{className:"flex-1 py-4",children:e.jsx("ul",{children:a.map(t=>e.jsx("li",{className:"px-2",children:e.jsx(Ke,{href:t.path,children:e.jsxs("a",{className:d("flex items-center px-4 py-3 rounded-r",s===t.path?"sidebar-active text-primary font-medium":"hover:bg-neutral-100 transition-colors"),children:[e.jsx("i",{className:`fas fa-${t.icon} mr-3 w-5 text-center`}),t.name]})})},t.name))})}),e.jsx("div",{className:"p-4 border-t border-neutral-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary flex items-center justify-center text-white",children:e.jsx("span",{className:"text-sm font-medium",children:"SJ"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-neutral-500",children:"Sarah Johnson"}),e.jsx("p",{className:"text-xs text-neutral-400",children:"HR Director"})]})]})})]})}function le(){const[s,a]=n.useState(!1),{data:t}=E({queryKey:["/api/settings"]});return e.jsx("header",{className:"bg-white border-b border-neutral-200 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsxs("div",{className:"flex items-center md:hidden",children:[e.jsx("button",{className:"text-neutral-500 hover:text-primary focus:outline-none",onClick:()=>{},children:e.jsx("i",{className:"fas fa-bars text-xl"})}),e.jsx("h1",{className:"text-xl font-semibold text-primary ml-3",children:"ProposalCraft"})]}),e.jsxs("div",{className:"flex-1 md:flex-initial flex justify-end items-center space-x-4",children:[e.jsx("div",{className:"relative",children:e.jsxs("button",{className:"text-neutral-500 hover:text-primary focus:outline-none",children:[e.jsx("i",{className:"fas fa-bell text-xl"}),e.jsx("span",{className:"absolute top-0 right-0 w-2 h-2 bg-primary rounded-full"})]})}),e.jsx("div",{className:"relative",children:e.jsx("button",{className:"text-neutral-500 hover:text-primary focus:outline-none",children:e.jsx("i",{className:"fas fa-question-circle text-xl"})})}),e.jsx("div",{className:"hidden md:flex items-center",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search...",className:"w-48 pl-9 pr-4 py-2 rounded-md border border-neutral-200 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary"}),e.jsx("i",{className:"fas fa-search absolute left-3 top-3 text-neutral-400"})]})})]})]})})}function ie(){const[s]=re(),a=[{name:"Home",path:"/",icon:"home"},{name:"Proposals",path:"/proposals",icon:"file-alt"},{name:"Templates",path:"/templates",icon:"folder-open"},{name:"Backup",path:"/backup",icon:"history"},{name:"Menu",path:"#",icon:"bars",onClick:()=>{}}];return e.jsx("div",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-neutral-200 z-10",children:e.jsx("div",{className:"flex justify-around",children:a.map(t=>e.jsx(Ke,{href:t.path,children:e.jsxs("a",{onClick:t.onClick,className:d("flex flex-col items-center p-3",s===t.path?"text-primary":"text-neutral-400"),children:[e.jsx("i",{className:`fas fa-${t.icon} text-lg`}),e.jsx("span",{className:"text-xs mt-1",children:t.name})]})},t.name))})})}function oa(){return e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-neutral-500",children:"Dashboard"}),e.jsx("p",{className:"text-neutral-400 mt-1",children:"Welcome back, Sarah! Here's what's happening with your proposals."})]})}const ca=Te("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),w=n.forwardRef(({className:s,variant:a,size:t,asChild:r=!1,...i},u)=>{const o=r?cs:"button";return e.jsx(o,{className:d(ca({variant:a,size:t,className:s})),ref:u,...i})});w.displayName="Button";function da(){const{toast:s}=he(),a=be(),[t,r]=n.useState(!1),{data:i,isLoading:u}=E({queryKey:["/api/settings"]}),{data:o,isLoading:y}=E({queryKey:["/api/backups"],select:j=>j.sort((P,I)=>new Date(I.createdAt).getTime()-new Date(P.createdAt).getTime())}),f=Y({mutationFn:async()=>{r(!0);const j=new Date,P=j.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}),I=j.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return(await B("POST","/api/backups",{name:`${P} - ${I}`,type:"manual"})).json()},onSuccess:()=>{a.invalidateQueries({queryKey:["/api/backups"]}),s({title:"Backup created",description:"Your data has been backed up successfully."})},onError:j=>{s({title:"Backup failed",description:"Unable to create backup. Please try again.",variant:"destructive"}),console.error("Backup creation failed:",j)},onSettled:()=>{r(!1)}}),l=o&&o.length>0?o[0]:null,S=l?new Date(l.createdAt):null,p=S?S.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"Never",h=S?S.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"",b=(o==null?void 0:o.reduce((j,P)=>{const I=P.size.match(/^(\d+(?:\.\d+)?)/),T=I?parseFloat(I[1]):0,A=P.size.includes("KB")?T/1024:T;return j+A},0))||0,N=b.toFixed(2),k="22.0",g=Math.min(100,Math.round(b/22*100));return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6 border border-neutral-200",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-neutral-500 flex items-center",children:[e.jsx("i",{className:"fas fa-cloud-upload-alt text-accent mr-2"}),"Automated Backup Status"]}),e.jsx("p",{className:"text-neutral-400 mt-1",children:i!=null&&i.backupEnabled?`Your data is automatically backed up every day at ${i.backupTime}`:"Automatic backups are disabled"})]}),e.jsxs("div",{className:"mt-3 md:mt-0",children:[e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-accent bg-opacity-10 text-accent",children:[e.jsx("i",{className:"fas fa-check-circle mr-1"}),l?"Up to date":"No backups yet"]}),e.jsxs("p",{className:"text-xs text-neutral-400 mt-1",children:["Last backup: ",p,h?`, ${h}`:""]})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-neutral-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-2 bg-neutral-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary rounded-full",style:{width:`${g}%`}})}),e.jsxs("div",{className:"mt-2 flex justify-between text-xs text-neutral-400",children:[e.jsxs("span",{children:[N," GB used"]}),e.jsxs("span",{children:[k," GB total"]})]})]}),e.jsxs("div",{className:"mt-4 sm:mt-0 sm:ml-4 flex space-x-2",children:[e.jsxs(w,{className:"bg-primary text-white hover:bg-primary-dark transition-colors text-sm font-medium",onClick:()=>f.mutate(),disabled:t,children:[e.jsx("i",{className:"fas fa-sync mr-1"}),t?"Backing up...":"Manual Backup"]}),e.jsxs(w,{variant:"outline",className:"border border-neutral-200 text-neutral-500 hover:bg-neutral-100 transition-colors text-sm font-medium",onClick:()=>window.location.href="/backup",children:[e.jsx("i",{className:"fas fa-cog mr-1"}),"Settings"]})]})]})})]})}function ma(){const{data:s,isLoading:a}=E({queryKey:["/api/proposals"]}),t=(s==null?void 0:s.length)||0,r=(s==null?void 0:s.filter(l=>l.status==="approved").length)||0,i=(s==null?void 0:s.filter(l=>l.status==="draft"||l.status==="sent").length)||0,f=[{title:"Active Proposals",value:t,icon:"file-alt",color:"primary",change:"+12%",isPositive:!0},{title:"Approved Proposals",value:r,icon:"check-circle",color:"secondary",change:"+5%",isPositive:!0},{title:"Pending Proposals",value:i,icon:"clock",color:"neutral-300",change:"-3%",isPositive:!1}];return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:f.map((l,S)=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 border border-neutral-200",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-12 h-12 rounded-full bg-${l.color} bg-opacity-10 flex items-center justify-center text-${l.color}`,children:e.jsx("i",{className:`fas fa-${l.icon} text-xl`})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-2xl font-semibold text-neutral-500",children:l.value}),e.jsx("p",{className:"text-neutral-400 text-sm",children:l.title})]})]}),e.jsxs("div",{className:`mt-3 text-xs ${l.isPositive?"text-accent":"text-error"}`,children:[e.jsx("i",{className:`fas fa-arrow-${l.isPositive?"up":"down"} mr-1`}),e.jsxs("span",{children:[l.change," from last month"]})]})]},S))})}function xa(){const[s,a]=re(),{data:t,isLoading:r}=E({queryKey:["/api/templates"]}),i=o=>{a(`/proposals/create?templateId=${o}`)},u=o=>{a(`/templates/${o}`)};return e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-neutral-500",children:"Create New Proposal"}),e.jsx("div",{className:"mt-2 md:mt-0",children:e.jsxs(w,{className:"bg-primary text-white hover:bg-primary-dark transition-colors text-sm font-medium",onClick:()=>a("/proposals/create"),children:[e.jsx("i",{className:"fas fa-plus mr-1"}),"Create from Scratch"]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"inline-flex space-x-4 min-w-full pb-2",children:r?e.jsx("div",{className:"flex justify-center w-full py-8",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-primary text-3xl"})}):t&&t.length>0?t.map(o=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-neutral-200 w-64 shrink-0",children:[e.jsx("div",{className:d("h-32 rounded-t-lg border-b border-neutral-200 flex items-center justify-center",`bg-${o.color} bg-opacity-5`),children:e.jsx("i",{className:d(`fas fa-${o.icon} text-5xl`,`text-${o.color} opacity-40`)})}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-neutral-500",children:o.name}),e.jsx("p",{className:"text-xs text-neutral-400 mt-1",children:o.description}),e.jsxs("div",{className:"mt-4 flex",children:[e.jsx(w,{className:"px-3 py-1.5 rounded-md bg-primary text-white hover:bg-primary-dark transition-colors text-xs font-medium flex-1",onClick:()=>i(o.id),children:"Use Template"}),e.jsx(w,{variant:"outline",className:"p-1.5 ml-2 rounded-md border border-neutral-200 text-neutral-500 hover:bg-neutral-100 transition-colors",onClick:()=>u(o.id),children:e.jsx("i",{className:"fas fa-eye"})})]})]})]},o.id)):e.jsx("div",{className:"flex justify-center w-full py-8 text-neutral-400",children:"No templates available"})})})]})}const Ie=Lt,Fe=Rt,Ce=n.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(ds,{ref:r,className:d("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...t,children:[a,e.jsx(kt,{asChild:!0,children:e.jsx(Ds,{className:"h-4 w-4 opacity-50"})})]}));Ce.displayName=ds.displayName;const Vs=n.forwardRef(({className:s,...a},t)=>e.jsx(ms,{ref:t,className:d("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(Ut,{className:"h-4 w-4"})}));Vs.displayName=ms.displayName;const zs=n.forwardRef(({className:s,...a},t)=>e.jsx(xs,{ref:t,className:d("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(Ds,{className:"h-4 w-4"})}));zs.displayName=xs.displayName;const Pe=n.forwardRef(({className:s,children:a,position:t="popper",...r},i)=>e.jsx(Ct,{children:e.jsxs(us,{ref:i,className:d("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:t,...r,children:[e.jsx(Vs,{}),e.jsx(Pt,{className:d("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),e.jsx(zs,{})]})}));Pe.displayName=us.displayName;const ua=n.forwardRef(({className:s,...a},t)=>e.jsx(ps,{ref:t,className:d("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...a}));ua.displayName=ps.displayName;const q=n.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(hs,{ref:r,className:d("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Tt,{children:e.jsx(qt,{className:"h-4 w-4"})})}),e.jsx(At,{children:a})]}));q.displayName=hs.displayName;const pa=n.forwardRef(({className:s,...a},t)=>e.jsx(fs,{ref:t,className:d("-mx-1 my-1 h-px bg-muted",s),...a}));pa.displayName=fs.displayName;function ha(){const[s,a]=re(),[t,r]=n.useState("all"),{data:i,isLoading:u}=E({queryKey:["/api/proposals"]}),{data:o}=E({queryKey:["/api/templates"]}),y=i==null?void 0:i.filter(N=>t==="all"?!0:N.status===t.toLowerCase()),f=y==null?void 0:y.sort((N,k)=>new Date(k.createdAt).getTime()-new Date(N.createdAt).getTime()),l=N=>{const k=o==null?void 0:o.find(g=>g.id===N);return(k==null?void 0:k.name)||"Unknown Template"},S=N=>new Date(N).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),p=N=>{switch(N){case"approved":return"bg-accent bg-opacity-10 text-accent";case"sent":return"bg-secondary bg-opacity-10 text-secondary";case"draft":return"bg-neutral-300 bg-opacity-10 text-neutral-500";case"rejected":return"bg-error bg-opacity-10 text-error";default:return"bg-neutral-300 bg-opacity-10 text-neutral-500"}},h=N=>{a(`/proposals/${N}`)},b=N=>{a(`/proposals/edit/${N}`)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-neutral-500",children:"Recent Proposals"}),e.jsxs("div",{className:"mt-2 md:mt-0 flex space-x-2",children:[e.jsxs(Ie,{value:t,onValueChange:r,children:[e.jsx(Ce,{className:"w-32 md:w-40",children:e.jsx(Fe,{placeholder:"All Proposals"})}),e.jsxs(Pe,{children:[e.jsx(q,{value:"all",children:"All Proposals"}),e.jsx(q,{value:"draft",children:"Draft"}),e.jsx(q,{value:"sent",children:"Sent"}),e.jsx(q,{value:"approved",children:"Approved"}),e.jsx(q,{value:"rejected",children:"Rejected"})]})]}),e.jsxs("a",{href:"/proposals",className:"text-primary text-sm flex items-center",children:["View All",e.jsx("i",{className:"fas fa-chevron-right ml-1 text-xs"})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-neutral-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-neutral-200",children:[e.jsx("thead",{className:"bg-neutral-100",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Proposal"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Client"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Created"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-neutral-200",children:u?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-primary"})})}):f&&f.length>0?f.slice(0,5).map(N=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"fas fa-file-alt text-primary mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-neutral-500",children:N.title}),e.jsx("div",{className:"text-xs text-neutral-400",children:l(N.templateId)})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-neutral-500",children:N.clientName})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-neutral-500",children:S(N.createdAt)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:d("px-2 inline-flex text-xs leading-5 font-semibold rounded-full",p(N.status)),children:N.status.charAt(0).toUpperCase()+N.status.slice(1)})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{className:"text-primary hover:text-primary-dark mr-3",onClick:()=>h(N.id),children:e.jsx("i",{className:"fas fa-eye"})}),e.jsx("button",{className:"text-neutral-400 hover:text-neutral-500 mr-3",onClick:()=>b(N.id),children:e.jsx("i",{className:"fas fa-edit"})}),e.jsx("button",{className:"text-neutral-400 hover:text-neutral-500",children:e.jsx("i",{className:"fas fa-ellipsis-v"})})]})]},N.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-neutral-400",children:"No proposals found"})})})]})})})]})}function fa(){return e.jsxs(e.Fragment,{children:[e.jsxs(me,{children:[e.jsx("title",{children:"Dashboard | ProposalCraft"}),e.jsx("meta",{name:"description",content:"Manage your HR proposals with the ProposalCraft dashboard. Create, manage, and track all your business proposals in one place."})]}),e.jsxs("div",{className:"bg-neutral-100 text-neutral-500 flex h-screen",children:[e.jsx(ne,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(le,{}),e.jsxs("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 pb-16 md:pb-6",children:[e.jsx(oa,{}),e.jsx(da,{}),e.jsxs("div",{className:"mb-6 mt-4 p-6 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-lg text-white shadow-lg flex flex-col md:flex-row justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Asset Boardroom League"}),e.jsx("p",{className:"text-blue-100 mb-4 md:mb-0",children:"Test your strategic decision-making skills in corporate finance and risk management"})]}),e.jsx(Ke,{href:"/game",children:e.jsxs(w,{size:"lg",variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(Es,{className:"h-5 w-5"}),"Play Now"]})})]}),e.jsx(ma,{}),e.jsx(xa,{}),e.jsx(ha,{})]}),e.jsx(ie,{})]})]})]})}const Ks=n.forwardRef(({className:s,...a},t)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:t,className:d("w-full caption-bottom text-sm",s),...a})}));Ks.displayName="Table";const Gs=n.forwardRef(({className:s,...a},t)=>e.jsx("thead",{ref:t,className:d("[&_tr]:border-b",s),...a}));Gs.displayName="TableHeader";const Hs=n.forwardRef(({className:s,...a},t)=>e.jsx("tbody",{ref:t,className:d("[&_tr:last-child]:border-0",s),...a}));Hs.displayName="TableBody";const ja=n.forwardRef(({className:s,...a},t)=>e.jsx("tfoot",{ref:t,className:d("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...a}));ja.displayName="TableFooter";const we=n.forwardRef(({className:s,...a},t)=>e.jsx("tr",{ref:t,className:d("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...a}));we.displayName="TableRow";const ge=n.forwardRef(({className:s,...a},t)=>e.jsx("th",{ref:t,className:d("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...a}));ge.displayName="TableHead";const de=n.forwardRef(({className:s,...a},t)=>e.jsx("td",{ref:t,className:d("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...a}));de.displayName="TableCell";const ga=n.forwardRef(({className:s,...a},t)=>e.jsx("caption",{ref:t,className:d("mt-4 text-sm text-muted-foreground",s),...a}));ga.displayName="TableCaption";const K=n.forwardRef(({className:s,type:a,...t},r)=>e.jsx("input",{type:a,className:d("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:r,...t}));K.displayName="Input";function Na(){const[s,a]=re(),[t,r]=n.useState("all"),[i,u]=n.useState(""),{data:o,isLoading:y}=E({queryKey:["/api/proposals"]}),{data:f}=E({queryKey:["/api/templates"]}),l=o==null?void 0:o.filter(g=>{const j=t==="all"||g.status===t.toLowerCase(),P=!i||g.title.toLowerCase().includes(i.toLowerCase())||g.clientName.toLowerCase().includes(i.toLowerCase());return j&&P}),S=l==null?void 0:l.sort((g,j)=>new Date(j.createdAt).getTime()-new Date(g.createdAt).getTime()),p=g=>{const j=f==null?void 0:f.find(P=>P.id===g);return(j==null?void 0:j.name)||"Unknown Template"},h=g=>new Date(g).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),b=g=>{switch(g){case"approved":return"bg-accent bg-opacity-10 text-accent";case"sent":return"bg-secondary bg-opacity-10 text-secondary";case"draft":return"bg-neutral-300 bg-opacity-10 text-neutral-500";case"rejected":return"bg-error bg-opacity-10 text-error";default:return"bg-neutral-300 bg-opacity-10 text-neutral-500"}},N=g=>{a(`/proposals/${g}`)},k=g=>{a(`/proposals/edit/${g}`)};return e.jsxs(e.Fragment,{children:[e.jsxs(me,{children:[e.jsx("title",{children:"My Proposals | ProposalCraft"}),e.jsx("meta",{name:"description",content:"View and manage all your HR proposals in one place. Filter, search, and organize your business proposals."})]}),e.jsxs("div",{className:"bg-neutral-100 text-neutral-500 flex h-screen",children:[e.jsx(ne,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(le,{}),e.jsxs("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 pb-16 md:pb-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-neutral-500",children:"My Proposals"}),e.jsx("p",{className:"text-neutral-400 mt-1",children:"View and manage all your business proposals"})]}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsxs(w,{className:"bg-primary text-white",onClick:()=>a("/proposals/create"),children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Create New Proposal"]})})]}),e.jsxs(R,{className:"mb-6",children:[e.jsx($,{className:"pb-3",children:e.jsx(O,{children:"Filters"})}),e.jsx(D,{children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"w-full md:w-1/3",children:e.jsx(K,{placeholder:"Search by title or client...",value:i,onChange:g=>u(g.target.value),className:"w-full"})}),e.jsx("div",{className:"w-full md:w-1/4",children:e.jsxs(Ie,{value:t,onValueChange:r,children:[e.jsx(Ce,{children:e.jsx(Fe,{placeholder:"All Proposals"})}),e.jsxs(Pe,{children:[e.jsx(q,{value:"all",children:"All Proposals"}),e.jsx(q,{value:"draft",children:"Draft"}),e.jsx(q,{value:"sent",children:"Sent"}),e.jsx(q,{value:"approved",children:"Approved"}),e.jsx(q,{value:"rejected",children:"Rejected"})]})]})})]})})]}),e.jsx(R,{children:e.jsx(D,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ks,{children:[e.jsx(Gs,{children:e.jsxs(we,{children:[e.jsx(ge,{children:"Proposal"}),e.jsx(ge,{children:"Client"}),e.jsx(ge,{children:"Created"}),e.jsx(ge,{children:"Status"}),e.jsx(ge,{className:"text-right",children:"Actions"})]})}),e.jsx(Hs,{children:y?e.jsx(we,{children:e.jsx(de,{colSpan:5,className:"text-center py-8",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-primary text-xl"})})}):S&&S.length>0?S.map(g=>e.jsxs(we,{children:[e.jsx(de,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"fas fa-file-alt text-primary mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-neutral-500",children:g.title}),e.jsx("div",{className:"text-xs text-neutral-400",children:p(g.templateId)})]})]})}),e.jsx(de,{children:e.jsx("div",{className:"text-sm text-neutral-500",children:g.clientName})}),e.jsx(de,{children:e.jsx("div",{className:"text-sm text-neutral-500",children:h(g.createdAt)})}),e.jsx(de,{children:e.jsx("span",{className:d("px-2 inline-flex text-xs leading-5 font-semibold rounded-full",b(g.status)),children:g.status.charAt(0).toUpperCase()+g.status.slice(1)})}),e.jsxs(de,{className:"text-right",children:[e.jsx("button",{className:"text-primary hover:text-primary-dark mr-3",onClick:()=>N(g.id),children:e.jsx("i",{className:"fas fa-eye"})}),e.jsx("button",{className:"text-neutral-400 hover:text-neutral-500 mr-3",onClick:()=>k(g.id),children:e.jsx("i",{className:"fas fa-edit"})}),e.jsx("button",{className:"text-neutral-400 hover:text-neutral-500",children:e.jsx("i",{className:"fas fa-ellipsis-v"})})]})]},g.id)):e.jsx(we,{children:e.jsx(de,{colSpan:5,className:"text-center py-8 text-neutral-400",children:i||t!=="all"?"No proposals match your filters":"No proposals found. Create your first proposal!"})})})]})})})})]}),e.jsx(ie,{})]})]})]})}function ba(){const[s,a]=re(),[t,r]=n.useState(""),{data:i,isLoading:u}=E({queryKey:["/api/templates"]}),o=i==null?void 0:i.filter(l=>!t||l.name.toLowerCase().includes(t.toLowerCase())||l.description.toLowerCase().includes(t.toLowerCase())),y=l=>{a(`/proposals/create?templateId=${l}`)},f=l=>{a(`/proposals/create?templateId=${l}`)};return e.jsxs(e.Fragment,{children:[e.jsxs(me,{children:[e.jsx("title",{children:"Templates | ProposalCraft"}),e.jsx("meta",{name:"description",content:"Browse and use professional HR proposal templates. Find the perfect template for your business proposals."})]}),e.jsxs("div",{className:"bg-neutral-100 text-neutral-500 flex h-screen",children:[e.jsx(ne,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(le,{}),e.jsxs("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 pb-16 md:pb-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-neutral-500",children:"Proposal Templates"}),e.jsx("p",{className:"text-neutral-400 mt-1",children:"Browse and use our professional proposal templates"})]}),e.jsx("div",{className:"mt-4 md:mt-0 w-full md:w-64",children:e.jsx(K,{placeholder:"Search templates...",value:t,onChange:l=>r(l.target.value),className:"w-full"})})]}),u?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-primary text-3xl"})}):o&&o.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(l=>e.jsxs(R,{className:"bg-white shadow-sm border border-neutral-200",children:[e.jsx("div",{className:d("h-32 rounded-t-lg border-b border-neutral-200 flex items-center justify-center",`bg-${l.color} bg-opacity-5`),children:e.jsx("i",{className:d(`fas fa-${l.icon} text-5xl`,`text-${l.color} opacity-40`)})}),e.jsxs(D,{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-neutral-500",children:l.name}),e.jsx("p",{className:"text-xs text-neutral-400 mt-1",children:l.description}),e.jsxs("div",{className:"mt-4 flex",children:[e.jsx(w,{className:"px-3 py-1.5 rounded-md bg-primary text-white hover:bg-primary-dark transition-colors text-xs font-medium flex-1",onClick:()=>y(l.id),children:"Use Template"}),e.jsx(w,{variant:"outline",className:"p-1.5 ml-2 rounded-md border border-neutral-200 text-neutral-500 hover:bg-neutral-100 transition-colors",onClick:()=>f(l.id),children:e.jsx("i",{className:"fas fa-eye"})})]})]})]},l.id))}):e.jsx(R,{className:"bg-white shadow-sm border border-neutral-200",children:e.jsxs(D,{className:"p-8 text-center",children:[e.jsx("i",{className:"fas fa-folder-open text-neutral-300 text-5xl mb-4"}),e.jsx("h3",{className:"text-xl font-medium text-neutral-500",children:"No Templates Found"}),e.jsx("p",{className:"text-neutral-400 mt-2",children:t?`No templates match "${t}". Try a different search term.`:"No templates are available at the moment."})]})})]}),e.jsx(ie,{})]})]})]})}const ya=ue("users",{id:pe("id").primaryKey(),username:L("username").notNull().unique(),password:L("password").notNull(),avatar:L("avatar"),totalPoints:X("total_points").default(0),techLevel:L("tech_level").default("beginner"),createdAt:ae("created_at").defaultNow(),lastLogin:ae("last_login")});xe(ya).pick({username:!0,password:!0,avatar:!0});const va=ue("scenarios",{id:pe("id").primaryKey(),question:L("question").notNull(),options:Ne("options").notNull(),scores:Ne("scores").notNull(),techLevel:L("tech_level").notNull(),category:L("category").notNull(),createdAt:ae("created_at").defaultNow()});xe(va).omit({id:!0,createdAt:!0});const wa=ue("game_sessions",{id:pe("id").primaryKey(),userId:X("user_id").notNull(),totalScore:X("total_score").notNull(),scenariosPlayed:Ne("scenarios_played").notNull(),techLevel:L("tech_level").notNull(),startTime:ae("start_time").notNull(),endTime:ae("end_time"),isCompleted:Bs("is_completed").default(!1)});xe(wa).omit({id:!0,endTime:!0,isCompleted:!0});const Sa=ue("player_responses",{id:pe("id").primaryKey(),sessionId:X("session_id").notNull(),scenarioId:X("scenario_id").notNull(),userId:X("user_id").notNull(),selectedOption:X("selected_option").notNull(),pointsEarned:X("points_earned").notNull(),responseTime:X("response_time"),timestamp:ae("timestamp").defaultNow()});xe(Sa).omit({id:!0,timestamp:!0});const ka=ue("templates",{id:pe("id").primaryKey(),name:L("name").notNull(),description:L("description").notNull(),content:Ne("content").notNull(),icon:L("icon").notNull(),color:L("color").notNull(),createdAt:ae("created_at").defaultNow()});xe(ka).omit({id:!0,createdAt:!0});const Ca=ue("proposals",{id:pe("id").primaryKey(),title:L("title").notNull(),clientName:L("client_name").notNull(),status:L("status").notNull(),templateId:X("template_id").notNull(),content:Ne("content").notNull(),createdAt:ae("created_at").defaultNow(),updatedAt:ae("updated_at").defaultNow()}),Pa=xe(Ca).omit({id:!0,createdAt:!0,updatedAt:!0}),Ta=ue("backups",{id:pe("id").primaryKey(),name:L("name").notNull(),type:L("type").notNull(),size:L("size").notNull(),data:Ne("data").notNull(),createdAt:ae("created_at").defaultNow()});xe(Ta).omit({id:!0,createdAt:!0});const Aa=ue("settings",{id:pe("id").primaryKey(),backupTime:L("backup_time").notNull().default("23:00"),backupEnabled:Bs("backup_enabled").notNull().default(!0),maxBackups:X("max_backups").notNull().default(30),companyName:L("company_name").notNull().default("Your Company"),companyLogo:L("company_logo"),companyAddress:L("company_address"),companyEmail:L("company_email"),companyPhone:L("company_phone")});xe(Aa).omit({id:!0});const La=Te("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Qs=n.forwardRef(({className:s,...a},t)=>e.jsx(js,{ref:t,className:d(La(),s),...a}));Qs.displayName=js.displayName;const Ys=Ht,Js=n.createContext({}),z=({...s})=>e.jsx(Js.Provider,{value:{name:s.name},children:e.jsx(Qt,{...s})}),Be=()=>{const s=n.useContext(Js),a=n.useContext(Ws),{getFieldState:t,formState:r}=Gt(),i=t(s.name,r);if(!s)throw new Error("useFormField should be used within <FormField>");const{id:u}=a;return{id:u,name:s.name,formItemId:`${u}-form-item`,formDescriptionId:`${u}-form-item-description`,formMessageId:`${u}-form-item-message`,...i}},Ws=n.createContext({}),M=n.forwardRef(({className:s,...a},t)=>{const r=n.useId();return e.jsx(Ws.Provider,{value:{id:r},children:e.jsx("div",{ref:t,className:d("space-y-2",s),...a})})});M.displayName="FormItem";const _=n.forwardRef(({className:s,...a},t)=>{const{error:r,formItemId:i}=Be();return e.jsx(Qs,{ref:t,className:d(r&&"text-destructive",s),htmlFor:i,...a})});_.displayName="FormLabel";const U=n.forwardRef(({...s},a)=>{const{error:t,formItemId:r,formDescriptionId:i,formMessageId:u}=Be();return e.jsx(cs,{ref:a,id:r,"aria-describedby":t?`${i} ${u}`:`${i}`,"aria-invalid":!!t,...s})});U.displayName="FormControl";const Se=n.forwardRef(({className:s,...a},t)=>{const{formDescriptionId:r}=Be();return e.jsx("p",{ref:t,id:r,className:d("text-sm text-muted-foreground",s),...a})});Se.displayName="FormDescription";const G=n.forwardRef(({className:s,children:a,...t},r)=>{const{error:i,formMessageId:u}=Be(),o=i?String((i==null?void 0:i.message)??""):a;return o?e.jsx("p",{ref:r,id:u,className:d("text-sm font-medium text-destructive",s),...t,children:o}):null});G.displayName="FormMessage";const Xs=n.forwardRef(({className:s,...a},t)=>e.jsx("textarea",{className:d("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...a}));Xs.displayName="Textarea";const Ae=Dt,ye=n.forwardRef(({className:s,...a},t)=>e.jsx(gs,{ref:t,className:d("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...a}));ye.displayName=gs.displayName;const ee=n.forwardRef(({className:s,...a},t)=>e.jsx(Ns,{ref:t,className:d("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...a}));ee.displayName=Ns.displayName;const se=n.forwardRef(({className:s,...a},t)=>e.jsx(bs,{ref:t,className:d("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a}));se.displayName=bs.displayName;const Ra=Pa.extend({title:V.string().min(3,"Title must be at least 3 characters"),clientName:V.string().min(2,"Client name must be at least 2 characters"),clientContactPerson:V.string().min(2,"Contact person must be at least 2 characters"),clientEmail:V.string().email("Please enter a valid email"),clientPhone:V.string().optional()});function Zs({proposalId:s,defaultTemplateId:a}){var T;const[t,r]=re(),{toast:i}=he(),u=be(),[o,y]=n.useState(0),f=s!==void 0,{data:l,isLoading:S}=E({queryKey:["/api/templates"]}),{data:p,isLoading:h}=E({queryKey:[`/api/proposals/${s}`],enabled:f}),b=Is({resolver:Fs(Ra),defaultValues:{title:"",clientName:"",status:"draft",templateId:a||0,content:{sections:[],clientDetails:{}},clientContactPerson:"",clientEmail:"",clientPhone:""}});n.useEffect(()=>{if(f&&p){const m=p.content.clientDetails||{};b.reset({...p,clientContactPerson:m.contactPerson||"",clientEmail:m.email||"",clientPhone:m.phone||""})}else if(!f&&a&&l){const m=l.find(A=>A.id===a);m&&(b.setValue("templateId",m.id),b.setValue("content",m.content))}},[p,l,a,b,f]);const N=m=>{const A=parseInt(m),F=l==null?void 0:l.find(J=>J.id===A);F&&(b.setValue("templateId",A),b.setValue("content",F.content))},k=(m,A)=>{const F=b.getValues("content"),J=[...F.sections||[]];J[m]&&(J[m]={...J[m],content:A},b.setValue("content",{...F,sections:J}))},g=Y({mutationFn:async m=>{const A={name:m.clientName,contactPerson:m.clientContactPerson,email:m.clientEmail,phone:m.clientPhone||""},F={title:m.title,clientName:m.clientName,status:m.status,templateId:m.templateId,content:{...m.content,clientDetails:A}};return f?(await B("PUT",`/api/proposals/${s}`,F)).json():(await B("POST","/api/proposals",F)).json()},onSuccess:m=>{u.invalidateQueries({queryKey:["/api/proposals"]}),i({title:f?"Proposal updated":"Proposal created",description:f?"Your proposal has been updated successfully.":"Your proposal has been created successfully."}),r(`/proposals/${m.id}`)},onError:m=>{i({title:"Error",description:`Failed to ${f?"update":"create"} proposal. Please try again.`,variant:"destructive"}),console.error(`Proposal ${f?"update":"creation"} failed:`,m)}}),j=m=>{g.mutate(m)},P=f&&h||S||g.isPending;l==null||l.find(m=>{var A;return m.id===parseInt(((A=b.watch("templateId"))==null?void 0:A.toString())||"0")});const I=((T=b.watch("content"))==null?void 0:T.sections)||[];return e.jsx(Ys,{...b,children:e.jsxs("form",{onSubmit:b.handleSubmit(j),className:"space-y-6",children:[e.jsxs(R,{children:[e.jsx($,{children:e.jsx(O,{children:f?"Edit Proposal":"Create New Proposal"})}),e.jsx(D,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(z,{control:b.control,name:"title",render:({field:m})=>e.jsxs(M,{children:[e.jsx(_,{children:"Proposal Title *"}),e.jsx(U,{children:e.jsx(K,{placeholder:"Enter proposal title",...m})}),e.jsx(G,{})]})}),e.jsx(z,{control:b.control,name:"status",render:({field:m})=>e.jsxs(M,{children:[e.jsx(_,{children:"Status"}),e.jsxs(Ie,{value:m.value,onValueChange:m.onChange,disabled:!f,children:[e.jsx(U,{children:e.jsx(Ce,{children:e.jsx(Fe,{placeholder:"Select status"})})}),e.jsxs(Pe,{children:[e.jsx(q,{value:"draft",children:"Draft"}),e.jsx(q,{value:"sent",children:"Sent"}),e.jsx(q,{value:"approved",children:"Approved"}),e.jsx(q,{value:"rejected",children:"Rejected"})]})]}),e.jsx(G,{})]})}),e.jsx(z,{control:b.control,name:"templateId",render:({field:m})=>{var A;return e.jsxs(M,{children:[e.jsx(_,{children:"Template *"}),e.jsxs(Ie,{value:(A=m.value)==null?void 0:A.toString(),onValueChange:N,disabled:f||S,children:[e.jsx(U,{children:e.jsx(Ce,{children:e.jsx(Fe,{placeholder:"Select a template"})})}),e.jsx(Pe,{children:l==null?void 0:l.map(F=>e.jsx(q,{value:F.id.toString(),children:F.name},F.id))})]}),e.jsx(G,{})]})}})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(z,{control:b.control,name:"clientName",render:({field:m})=>e.jsxs(M,{children:[e.jsx(_,{children:"Client Name *"}),e.jsx(U,{children:e.jsx(K,{placeholder:"Enter client name",...m})}),e.jsx(G,{})]})}),e.jsx(z,{control:b.control,name:"clientContactPerson",render:({field:m})=>e.jsxs(M,{children:[e.jsx(_,{children:"Contact Person *"}),e.jsx(U,{children:e.jsx(K,{placeholder:"Enter contact person name",...m})}),e.jsx(G,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(z,{control:b.control,name:"clientEmail",render:({field:m})=>e.jsxs(M,{children:[e.jsx(_,{children:"Email *"}),e.jsx(U,{children:e.jsx(K,{type:"email",placeholder:"Enter email",...m})}),e.jsx(G,{})]})}),e.jsx(z,{control:b.control,name:"clientPhone",render:({field:m})=>e.jsxs(M,{children:[e.jsx(_,{children:"Phone"}),e.jsx(U,{children:e.jsx(K,{placeholder:"Enter phone number",...m})}),e.jsx(G,{})]})})]})]})]})})]}),e.jsxs(R,{children:[e.jsx($,{children:e.jsx(O,{children:"Proposal Content"})}),e.jsx(D,{children:I&&I.length>0?e.jsxs(Ae,{defaultValue:"0",className:"w-full",value:o.toString(),onValueChange:m=>y(parseInt(m)),children:[e.jsx(ye,{className:"grid grid-cols-2 md:grid-cols-5 lg:flex lg:flex-wrap",children:I.map((m,A)=>e.jsx(ee,{value:A.toString(),className:"whitespace-nowrap",children:m.title},A))}),I.map((m,A)=>e.jsx(se,{value:A.toString(),className:"mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:m.title}),e.jsx(Xs,{placeholder:`Enter content for ${m.title}`,defaultValue:m.content,className:"min-h-32",onChange:F=>k(A,F.target.value)})]})},A))]}):e.jsx("div",{className:"text-center py-8 text-neutral-400",children:S?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("i",{className:"fas fa-spinner fa-spin text-2xl mb-2"}),e.jsx("p",{children:"Loading template content..."})]}):e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("i",{className:"fas fa-file-alt text-2xl mb-2"}),e.jsx("p",{children:"Select a template to load content sections"})]})})})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(w,{type:"button",variant:"outline",onClick:()=>r("/proposals"),children:"Cancel"}),e.jsx(w,{type:"submit",className:"bg-primary text-white",disabled:P,children:P?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),f?"Updating...":"Creating..."]}):f?"Update Proposal":"Create Proposal"})]})]})})}function Da(){const[s]=re(),t=new URLSearchParams(s.split("?")[1]).get("templateId");return e.jsxs(e.Fragment,{children:[e.jsxs(me,{children:[e.jsx("title",{children:"Create Proposal | ProposalCraft"}),e.jsx("meta",{name:"description",content:"Create a new professional business proposal using our intuitive form builder."})]}),e.jsxs("div",{className:"bg-neutral-100 text-neutral-500 flex h-screen",children:[e.jsx(ne,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(le,{}),e.jsxs("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 pb-16 md:pb-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-neutral-500",children:"Create New Proposal"}),e.jsx("p",{className:"text-neutral-400 mt-1",children:"Fill out the form below to create a professional business proposal"})]}),e.jsx(Zs,{defaultTemplateId:t?parseInt(t):void 0})]}),e.jsx(ie,{})]})]})]})}function Ea({params:s}){const a=parseInt(s.id);return e.jsxs(e.Fragment,{children:[e.jsxs(me,{children:[e.jsx("title",{children:"Edit Proposal | ProposalCraft"}),e.jsx("meta",{name:"description",content:"Edit your existing business proposal and make updates as needed."})]}),e.jsxs("div",{className:"bg-neutral-100 text-neutral-500 flex h-screen",children:[e.jsx(ne,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(le,{}),e.jsxs("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 pb-16 md:pb-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-neutral-500",children:"Edit Proposal"}),e.jsx("p",{className:"text-neutral-400 mt-1",children:"Update the details of your proposal"})]}),e.jsx(Zs,{proposalId:a})]}),e.jsx(ie,{})]})]})]})}const et=Ft,Ia=Et,st=n.forwardRef(({className:s,...a},t)=>e.jsx(ys,{ref:t,className:d("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a}));st.displayName=ys.displayName;const Ge=n.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(Ia,{children:[e.jsx(st,{}),e.jsxs(vs,{ref:r,className:d("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t,children:[a,e.jsxs(It,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Rs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ge.displayName=vs.displayName;const He=({className:s,...a})=>e.jsx("div",{className:d("flex flex-col space-y-1.5 text-center sm:text-left",s),...a});He.displayName="DialogHeader";const Qe=({className:s,...a})=>e.jsx("div",{className:d("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a});Qe.displayName="DialogFooter";const Ye=n.forwardRef(({className:s,...a},t)=>e.jsx(ws,{ref:t,className:d("text-lg font-semibold leading-none tracking-tight",s),...a}));Ye.displayName=ws.displayName;const Je=n.forwardRef(({className:s,...a},t)=>e.jsx(Ss,{ref:t,className:d("text-sm text-muted-foreground",s),...a}));Je.displayName=Ss.displayName;const Fa=Te("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ee({className:s,variant:a,...t}){return e.jsx("div",{className:d(Fa({variant:a}),s),...t})}function Ba({proposalId:s}){var I;const[a,t]=re(),{toast:r}=he(),i=be(),[u,o]=n.useState("details"),[y,f]=n.useState(!1),[l,S]=n.useState(!1),{data:p,isLoading:h}=E({queryKey:[`/api/proposals/${s}`]}),{data:b}=E({queryKey:[`/api/templates/${p==null?void 0:p.templateId}`],enabled:!!(p!=null&&p.templateId)}),N=Y({mutationFn:async()=>await B("DELETE",`/api/proposals/${s}`,{}),onSuccess:()=>{i.invalidateQueries({queryKey:["/api/proposals"]}),r({title:"Proposal deleted",description:"Your proposal has been deleted successfully."}),t("/proposals")},onError:T=>{r({title:"Delete failed",description:"Unable to delete proposal. Please try again.",variant:"destructive"}),console.error("Proposal deletion failed:",T)}}),k=T=>T?new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A",g=T=>{if(!T)return null;const m={approved:"bg-accent text-white",sent:"bg-secondary text-white",draft:"bg-neutral-300 text-neutral-700",rejected:"bg-error text-white"};return e.jsx(Ee,{className:d(m[T]||"bg-neutral-300 text-neutral-700"),children:T.charAt(0).toUpperCase()+T.slice(1)})},j=async()=>{try{if(S(!0),!(await fetch(`/api/proposals/${s}/export`)).ok)throw new Error("Failed to export PDF");r({title:"PDF Generated",description:"Your proposal has been exported as PDF."})}catch(T){r({title:"Export failed",description:"Unable to export proposal as PDF. Please try again.",variant:"destructive"}),console.error("PDF export failed:",T)}finally{S(!1)}},P=(p==null?void 0:p.content.clientDetails)||{};return e.jsx("div",{className:"space-y-6",children:h?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-primary text-3xl"})}):p?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-semibold text-neutral-500 flex items-center gap-3",children:[p.title,g(p.status)]}),e.jsxs("p",{className:"text-neutral-400 mt-1",children:["Created on ",k(p.createdAt),"  Last updated on ",k(p.updatedAt)]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(w,{onClick:j,disabled:l,className:"bg-secondary text-white",children:[e.jsx("i",{className:`fas fa-${l?"spinner fa-spin":"file-pdf"} mr-2`}),l?"Generating...":"Export PDF"]}),e.jsxs(w,{variant:"outline",onClick:()=>t(`/proposals/edit/${s}`),children:[e.jsx("i",{className:"fas fa-edit mr-2"}),"Edit"]}),e.jsxs(w,{variant:"outline",className:"border-error text-error hover:bg-error hover:text-white",onClick:()=>f(!0),children:[e.jsx("i",{className:"fas fa-trash-alt mr-2"}),"Delete"]})]})]}),e.jsxs(Ae,{value:u,onValueChange:o,children:[e.jsxs(ye,{children:[e.jsx(ee,{value:"details",children:"Proposal Details"}),e.jsx(ee,{value:"content",children:"Proposal Content"})]}),e.jsx(se,{value:"details",className:"mt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(R,{children:[e.jsx($,{children:e.jsx(O,{children:"Proposal Information"})}),e.jsx(D,{children:e.jsxs("dl",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-neutral-500",children:"Template"}),e.jsx("dd",{className:"text-neutral-700 mt-1",children:(b==null?void 0:b.name)||"Unknown Template"})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-neutral-500",children:"Status"}),e.jsx("dd",{className:"mt-1",children:g(p.status)})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-neutral-500",children:"Created Date"}),e.jsx("dd",{className:"text-neutral-700 mt-1",children:k(p.createdAt)})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-neutral-500",children:"Last Updated"}),e.jsx("dd",{className:"text-neutral-700 mt-1",children:k(p.updatedAt)})]})]})})]}),e.jsxs(R,{children:[e.jsx($,{children:e.jsx(O,{children:"Client Information"})}),e.jsx(D,{children:e.jsxs("dl",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-neutral-500",children:"Client Name"}),e.jsx("dd",{className:"text-neutral-700 mt-1",children:p.clientName})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-neutral-500",children:"Contact Person"}),e.jsx("dd",{className:"text-neutral-700 mt-1",children:P.contactPerson||"N/A"})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-neutral-500",children:"Email"}),e.jsx("dd",{className:"text-neutral-700 mt-1",children:P.email?e.jsx("a",{href:`mailto:${P.email}`,className:"text-primary hover:underline",children:P.email}):"N/A"})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-neutral-500",children:"Phone"}),e.jsx("dd",{className:"text-neutral-700 mt-1",children:P.phone?e.jsx("a",{href:`tel:${P.phone}`,className:"text-primary hover:underline",children:P.phone}):"N/A"})]})]})})]})]})}),e.jsx(se,{value:"content",className:"mt-6",children:e.jsxs(R,{children:[e.jsxs($,{children:[e.jsx(O,{children:"Proposal Content"}),e.jsx(Z,{children:"Below is the full content of your proposal structured by sections."})]}),e.jsxs(D,{children:[(I=p.content.sections)==null?void 0:I.map((T,m)=>e.jsxs("div",{className:"mb-6 last:mb-0",children:[e.jsx("h3",{className:"text-lg font-medium text-neutral-700 mb-2",children:T.title}),e.jsx("div",{className:"whitespace-pre-line bg-neutral-50 p-4 rounded-md border border-neutral-200",children:T.content||"No content provided"})]},m)),(!p.content.sections||p.content.sections.length===0)&&e.jsxs("div",{className:"text-center py-8 text-neutral-400",children:[e.jsx("i",{className:"fas fa-file-alt text-2xl mb-2"}),e.jsx("p",{children:"This proposal doesn't have any content sections"})]})]})]})})]}),e.jsx(et,{open:y,onOpenChange:f,children:e.jsxs(Ge,{children:[e.jsxs(He,{children:[e.jsx(Ye,{children:"Delete Proposal"}),e.jsx(Je,{children:"Are you sure you want to delete this proposal? This action cannot be undone."})]}),e.jsxs(Qe,{children:[e.jsx(w,{variant:"outline",onClick:()=>f(!1),children:"Cancel"}),e.jsx(w,{className:"bg-error text-white hover:bg-error/90",onClick:()=>N.mutate(),disabled:N.isPending,children:N.isPending?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Deleting..."]}):"Delete Proposal"})]})]})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-xl font-medium text-neutral-500",children:"Proposal not found"}),e.jsx("p",{className:"text-neutral-400 mt-2",children:"The proposal you're looking for doesn't exist or has been deleted."}),e.jsx(w,{className:"mt-4 bg-primary text-white",onClick:()=>t("/proposals"),children:"Back to Proposals"})]})})}function $a({params:s}){const a=parseInt(s.id),{data:t}=E({queryKey:[`/api/proposals/${a}`]});return e.jsxs(e.Fragment,{children:[e.jsxs(me,{children:[e.jsxs("title",{children:[(t==null?void 0:t.title)||"View Proposal"," | ProposalCraft"]}),e.jsx("meta",{name:"description",content:"View the details of your business proposal and export it as a PDF."})]}),e.jsxs("div",{className:"bg-neutral-100 text-neutral-500 flex h-screen",children:[e.jsx(ne,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(le,{}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 pb-16 md:pb-6",children:e.jsx(Ba,{proposalId:a})}),e.jsx(ie,{})]})]})]})}function Oa({isOpen:s,onClose:a}){const{toast:t}=he(),r=be(),[i,u]=n.useState(null),{data:o,isLoading:y}=E({queryKey:["/api/backups"],select:h=>h.sort((b,N)=>new Date(N.createdAt).getTime()-new Date(b.createdAt).getTime()),enabled:s}),f=Y({mutationFn:async h=>(await B("POST",`/api/backups/${h}/restore`,{})).json(),onSuccess:()=>{t({title:"Backup restored",description:"Your data has been restored successfully."}),r.invalidateQueries(),a()},onError:h=>{t({title:"Restore failed",description:"Unable to restore backup. Please try again.",variant:"destructive"}),console.error("Backup restoration failed:",h)}}),l=h=>new Date(h).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}),S=h=>new Date(h).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),p=()=>{i!==null?f.mutate(i):t({title:"No backup selected",description:"Please select a backup to restore.",variant:"destructive"})};return e.jsx(et,{open:s,onOpenChange:a,children:e.jsxs(Ge,{className:"sm:max-w-md",children:[e.jsxs(He,{children:[e.jsx(Ye,{className:"text-lg font-medium bg-primary text-white -mx-6 -mt-6 px-6 py-4",children:"Data Recovery"}),e.jsx(Je,{className:"pt-4",children:"Select a backup point to restore your data to a previous state:"})]}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:y?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-primary text-xl"})}):o&&o.length>0?o.map(h=>e.jsx("div",{className:`p-3 border ${i===h.id?"border-primary bg-primary bg-opacity-5":"border-neutral-200"} rounded-md hover:border-primary hover:bg-primary hover:bg-opacity-5 cursor-pointer transition-colors`,onClick:()=>u(h.id),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-neutral-500",children:[l(h.createdAt)," - ",S(h.createdAt)]}),e.jsxs("p",{className:"text-xs text-neutral-400 mt-1",children:[h.type.charAt(0).toUpperCase()+h.type.slice(1)," Backup - ",h.size]})]}),e.jsx("i",{className:"fas fa-cloud-download-alt text-lg text-primary"})]})},h.id)):e.jsx("div",{className:"text-center py-4 text-neutral-400",children:"No backups available"})}),e.jsxs(Qe,{className:"bg-neutral-100 -mx-6 -mb-6 px-6 py-3 flex justify-end space-x-2",children:[e.jsx(w,{variant:"outline",onClick:a,className:"border border-neutral-300 text-neutral-500 hover:bg-neutral-200 transition-colors",children:"Cancel"}),e.jsx(w,{onClick:p,disabled:i===null||f.isPending,className:"bg-primary text-white hover:bg-primary-dark transition-colors",children:f.isPending?"Restoring...":"Restore Selected"})]})]})})}function Ma(s){return new Date(s).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}function _a(s){let a=0;s.forEach(i=>{const u=i.size.match(/^(\d+(?:\.\d+)?)/),o=u?parseFloat(u[1]):0,f=i.size.includes("KB")?o/1024:o;a+=f});const t=a/1024,r=`${t.toFixed(2)} GB`;return{sizeInGb:t,formattedSize:r}}function Ua(){const{toast:s}=he(),a=be(),[t,r]=n.useState("backups"),[i,u]=n.useState(!1),[o,y]=n.useState(!1),[f,l]=n.useState(null),{data:S,isLoading:p}=E({queryKey:["/api/backups"],select:j=>j.sort((P,I)=>new Date(I.createdAt).getTime()-new Date(P.createdAt).getTime())}),{data:h}=E({queryKey:["/api/settings"]}),b=Y({mutationFn:async()=>{y(!0);const j=new Date,P=j.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}),I=j.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return(await B("POST","/api/backups",{name:`${P} - ${I}`,type:"manual"})).json()},onSuccess:()=>{a.invalidateQueries({queryKey:["/api/backups"]}),s({title:"Backup created",description:"Your data has been backed up successfully."})},onError:j=>{s({title:"Backup failed",description:"Unable to create backup. Please try again.",variant:"destructive"}),console.error("Backup creation failed:",j)},onSettled:()=>{y(!1)}}),N=Y({mutationFn:async j=>await B("DELETE",`/api/backups/${j}`,null),onSuccess:()=>{a.invalidateQueries({queryKey:["/api/backups"]}),s({title:"Backup deleted",description:"The backup has been deleted successfully."})},onError:j=>{s({title:"Delete failed",description:"Unable to delete backup. Please try again.",variant:"destructive"}),console.error("Backup deletion failed:",j)}}),k=S?_a(S):{sizeInGb:0,formattedSize:"0.00 GB"},g=Math.min(100,Math.round(k.sizeInGb/22*100));return e.jsxs(e.Fragment,{children:[e.jsxs(me,{children:[e.jsx("title",{children:"Backup & Recovery | ProposalCraft"}),e.jsx("meta",{name:"description",content:"Manage your proposal data backups and restore from previous backup points."})]}),e.jsxs("div",{className:"bg-neutral-100 text-neutral-500 flex h-screen",children:[e.jsx(ne,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(le,{}),e.jsxs("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 pb-16 md:pb-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-neutral-500",children:"Backup & Recovery"}),e.jsx("p",{className:"text-neutral-400 mt-1",children:"Manage your data backups and restore from previous states"})]}),e.jsx(R,{className:"mb-6",children:e.jsx(D,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary bg-opacity-10 flex items-center justify-center text-primary",children:e.jsx("i",{className:"fas fa-cloud-upload-alt text-xl"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-neutral-500",children:"Storage Summary"}),e.jsx("p",{className:"text-neutral-400 mt-1",children:h!=null&&h.backupEnabled?`Automatic backups are scheduled daily at ${h.backupTime}`:"Automatic backups are currently disabled"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"h-2 bg-neutral-100 rounded-full overflow-hidden w-full md:w-80",children:e.jsx("div",{className:"h-full bg-primary rounded-full",style:{width:`${g}%`}})}),e.jsxs("div",{className:"mt-2 flex justify-between text-xs text-neutral-400 w-full md:w-80",children:[e.jsxs("span",{children:[k.formattedSize," used"]}),e.jsx("span",{children:"22.0 GB total"})]})]})]})]}),e.jsxs("div",{className:"mt-4 md:mt-0 flex flex-col gap-2",children:[e.jsxs(w,{className:"bg-primary text-white",onClick:()=>b.mutate(),disabled:o,children:[e.jsx("i",{className:`fas fa-${o?"spinner fa-spin":"plus"} mr-2`}),o?"Creating Backup...":"Create New Backup"]}),e.jsxs(w,{variant:"outline",onClick:()=>u(!0),children:[e.jsx("i",{className:"fas fa-history mr-2"}),"Restore from Backup"]})]})]})})}),e.jsxs(Ae,{value:t,onValueChange:r,children:[e.jsxs(ye,{children:[e.jsx(ee,{value:"backups",children:"Backup History"}),e.jsx(ee,{value:"schedule",children:"Backup Schedule"})]}),e.jsx(se,{value:"backups",className:"mt-6",children:e.jsxs(R,{children:[e.jsxs($,{children:[e.jsx(O,{children:"Backup History"}),e.jsx(Z,{children:"View and manage your previously created backups"})]}),e.jsx(D,{children:p?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-primary text-3xl"})}):S&&S.length>0?e.jsx("div",{className:"space-y-4",children:S.map(j=>e.jsx("div",{className:"p-4 border border-neutral-200 rounded-md hover:border-primary hover:bg-primary hover:bg-opacity-5 transition-colors",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:`fas fa-${j.type==="automatic"?"clock":"user"} text-primary mr-2`}),e.jsx("h4",{className:"font-medium text-neutral-500",children:j.name})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 md:gap-4 mt-2",children:[e.jsxs("span",{className:"text-xs text-neutral-400",children:["Created: ",Ma(j.createdAt)]}),e.jsxs("span",{className:"text-xs text-neutral-400",children:["Type: ",j.type.charAt(0).toUpperCase()+j.type.slice(1)]}),e.jsxs("span",{className:"text-xs text-neutral-400",children:["Size: ",j.size]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4 md:mt-0",children:[e.jsxs(w,{variant:"outline",className:"text-xs",onClick:()=>{l(j.id),u(!0)},children:[e.jsx("i",{className:"fas fa-undo-alt mr-1"}),"Restore"]}),e.jsxs(w,{variant:"outline",className:"text-xs text-error hover:bg-error hover:text-white",onClick:()=>N.mutate(j.id),disabled:N.isPending,children:[e.jsx("i",{className:"fas fa-trash-alt mr-1"}),"Delete"]})]})]})},j.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"fas fa-database text-neutral-300 text-4xl mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-neutral-500",children:"No Backups Found"}),e.jsx("p",{className:"text-neutral-400 mt-2",children:"You haven't created any backups yet."}),e.jsxs(w,{className:"mt-4 bg-primary text-white",onClick:()=>b.mutate(),disabled:o,children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Create First Backup"]})]})})]})}),e.jsx(se,{value:"schedule",className:"mt-6",children:e.jsxs(R,{children:[e.jsxs($,{children:[e.jsx(O,{children:"Backup Schedule"}),e.jsx(Z,{children:"Configure when automated backups should run"})]}),e.jsxs(D,{children:[e.jsxs("p",{className:"text-neutral-400 mb-4",children:["Automatic backups are currently",e.jsxs("span",{className:h!=null&&h.backupEnabled?"text-accent font-medium":"text-error font-medium",children:[" ",h!=null&&h.backupEnabled?"enabled":"disabled"," "]}),"and scheduled to run daily at",e.jsxs("span",{className:"font-medium text-neutral-500",children:[" ",(h==null?void 0:h.backupTime)||"23:00"]}),"."]}),e.jsxs("p",{className:"text-neutral-400 mb-4",children:["The system will keep a maximum of",e.jsxs("span",{className:"font-medium text-neutral-500",children:[" ",(h==null?void 0:h.maxBackups)||30," backups"]}),". Older backups will be automatically deleted."]}),e.jsx("p",{className:"text-sm text-neutral-400 italic",children:"Note: To change these settings, please visit the Settings page."})]})]})})]})]}),e.jsx(ie,{})]})]}),e.jsx(Oa,{isOpen:i,onClose:()=>{u(!1),l(null)}})]})}const tt=n.forwardRef(({className:s,...a},t)=>e.jsx(ks,{className:d("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...a,ref:t,children:e.jsx(Bt,{className:d("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));tt.displayName=ks.displayName;const qa=V.object({companyName:V.string().min(1,"Company name is required"),companyLogo:V.string().optional(),companyAddress:V.string().optional(),companyEmail:V.string().email("Invalid email address").optional().or(V.literal("")),companyPhone:V.string().optional(),backupEnabled:V.boolean(),backupTime:V.string().regex(/^([01]\d|2[0-3]):([0-5]\d)$/,"Invalid time format (HH:MM)"),maxBackups:V.number().int().min(1,"Must keep at least 1 backup").max(100,"Cannot exceed 100 backups")});function Va(){const{toast:s}=he(),a=be(),[t,r]=n.useState("company"),{data:i,isLoading:u}=E({queryKey:["/api/settings"]}),o=Is({resolver:Fs(qa),defaultValues:{companyName:"Your Company",companyLogo:"",companyAddress:"",companyEmail:"",companyPhone:"",backupEnabled:!0,backupTime:"23:00",maxBackups:30}});n.useEffect(()=>{i&&o.reset({companyName:i.companyName,companyLogo:i.companyLogo||"",companyAddress:i.companyAddress||"",companyEmail:i.companyEmail||"",companyPhone:i.companyPhone||"",backupEnabled:i.backupEnabled,backupTime:i.backupTime,maxBackups:i.maxBackups})},[i,o]);const y=Y({mutationFn:async l=>(await B("PUT","/api/settings",l)).json(),onSuccess:()=>{a.invalidateQueries({queryKey:["/api/settings"]}),s({title:"Settings updated",description:"Your settings have been saved successfully."})},onError:l=>{s({title:"Update failed",description:"Unable to update settings. Please try again.",variant:"destructive"}),console.error("Settings update failed:",l)}}),f=l=>{y.mutate(l)};return u?e.jsxs("div",{className:"bg-neutral-100 text-neutral-500 flex h-screen",children:[e.jsx(ne,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(le,{}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 pb-16 md:pb-6 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-primary text-3xl"})}),e.jsx(ie,{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(me,{children:[e.jsx("title",{children:"Settings | ProposalCraft"}),e.jsx("meta",{name:"description",content:"Configure your application settings, company information, and backup preferences."})]}),e.jsxs("div",{className:"bg-neutral-100 text-neutral-500 flex h-screen",children:[e.jsx(ne,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(le,{}),e.jsxs("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 pb-16 md:pb-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-neutral-500",children:"Settings"}),e.jsx("p",{className:"text-neutral-400 mt-1",children:"Configure your application preferences"})]}),e.jsx(Ys,{...o,children:e.jsx("form",{onSubmit:o.handleSubmit(f),children:e.jsxs(Ae,{value:t,onValueChange:r,children:[e.jsxs(ye,{className:"mb-6",children:[e.jsx(ee,{value:"company",children:"Company Information"}),e.jsx(ee,{value:"backup",children:"Backup Settings"})]}),e.jsx(se,{value:"company",children:e.jsxs(R,{children:[e.jsxs($,{children:[e.jsx(O,{children:"Company Details"}),e.jsx(Z,{children:"This information will appear on your proposals"})]}),e.jsxs(D,{className:"space-y-6",children:[e.jsx(z,{control:o.control,name:"companyName",render:({field:l})=>e.jsxs(M,{children:[e.jsx(_,{children:"Company Name *"}),e.jsx(U,{children:e.jsx(K,{placeholder:"Enter your company name",...l})}),e.jsx(G,{})]})}),e.jsx(z,{control:o.control,name:"companyLogo",render:({field:l})=>e.jsxs(M,{children:[e.jsx(_,{children:"Company Logo URL"}),e.jsx(U,{children:e.jsx(K,{placeholder:"Enter logo URL",...l})}),e.jsx(Se,{children:"Enter a URL to your company logo image"}),e.jsx(G,{})]})}),e.jsx(z,{control:o.control,name:"companyAddress",render:({field:l})=>e.jsxs(M,{children:[e.jsx(_,{children:"Address"}),e.jsx(U,{children:e.jsx(K,{placeholder:"Enter company address",...l})}),e.jsx(G,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(z,{control:o.control,name:"companyEmail",render:({field:l})=>e.jsxs(M,{children:[e.jsx(_,{children:"Email"}),e.jsx(U,{children:e.jsx(K,{placeholder:"Enter company email",type:"email",...l})}),e.jsx(G,{})]})}),e.jsx(z,{control:o.control,name:"companyPhone",render:({field:l})=>e.jsxs(M,{children:[e.jsx(_,{children:"Phone"}),e.jsx(U,{children:e.jsx(K,{placeholder:"Enter company phone",...l})}),e.jsx(G,{})]})})]})]})]})}),e.jsx(se,{value:"backup",children:e.jsxs(R,{children:[e.jsxs($,{children:[e.jsx(O,{children:"Backup Configuration"}),e.jsx(Z,{children:"Configure how and when automated backups should run"})]}),e.jsxs(D,{className:"space-y-6",children:[e.jsx(z,{control:o.control,name:"backupEnabled",render:({field:l})=>e.jsxs(M,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(_,{className:"text-base",children:"Automatic Backups"}),e.jsx(Se,{children:"Enable or disable daily automatic backups"})]}),e.jsx(U,{children:e.jsx(tt,{checked:l.value,onCheckedChange:l.onChange})})]})}),e.jsx(z,{control:o.control,name:"backupTime",render:({field:l})=>e.jsxs(M,{children:[e.jsx(_,{children:"Backup Time"}),e.jsx(U,{children:e.jsx(K,{type:"time",...l,disabled:!o.watch("backupEnabled")})}),e.jsx(Se,{children:"Set the time of day when automatic backups should run (24-hour format)"}),e.jsx(G,{})]})}),e.jsx(z,{control:o.control,name:"maxBackups",render:({field:l})=>e.jsxs(M,{children:[e.jsx(_,{children:"Maximum Backups"}),e.jsx(U,{children:e.jsx(K,{type:"number",min:"1",max:"100",...l,onChange:S=>l.onChange(parseInt(S.target.value)||30),disabled:!o.watch("backupEnabled")})}),e.jsx(Se,{children:"Set the maximum number of backups to keep (older backups will be automatically deleted)"}),e.jsx(G,{})]})})]})]})}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(w,{type:"submit",className:"bg-primary text-white",disabled:y.isPending,children:y.isPending?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Saving..."]}):"Save Settings"})})]})})})]}),e.jsx(ie,{})]})]})]})}const at=n.forwardRef(({className:s,value:a,...t},r)=>e.jsx(Cs,{ref:r,className:d("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...t,children:e.jsx($t,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));at.displayName=Cs.displayName;const qe=n.forwardRef(({className:s,...a},t)=>e.jsx(Ps,{ref:t,className:d("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...a}));qe.displayName=Ps.displayName;const za=n.forwardRef(({className:s,...a},t)=>e.jsx(Ts,{ref:t,className:d("aspect-square h-full w-full",s),...a}));za.displayName=Ts.displayName;const Ve=n.forwardRef(({className:s,...a},t)=>e.jsx(As,{ref:t,className:d("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...a}));Ve.displayName=As.displayName;const ze=n.forwardRef(({className:s,orientation:a="horizontal",decorative:t=!0,...r},i)=>e.jsx(Ls,{ref:i,decorative:t,orientation:a,className:d("shrink-0 bg-border",a==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...r}));ze.displayName=Ls.displayName;const Ka=Te("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),rt=n.forwardRef(({className:s,variant:a,...t},r)=>e.jsx("div",{ref:r,role:"alert",className:d(Ka({variant:a}),s),...t}));rt.displayName="Alert";const nt=n.forwardRef(({className:s,...a},t)=>e.jsx("h5",{ref:t,className:d("mb-1 font-medium leading-none tracking-tight",s),...a}));nt.displayName="AlertTitle";const lt=n.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:d("text-sm [&_p]:leading-relaxed",s),...a}));lt.displayName="AlertDescription";function Ga(){re();const{toast:s}=he(),[a,t]=n.useState("play"),[r,i]=n.useState(null),[u,o]=n.useState(!1),[y,f]=n.useState(null),[l,S]=n.useState(0),[p,h]=n.useState(null),[b,N]=n.useState(null),[k,g]=n.useState(!1),[j,P]=n.useState(60),[I,T]=n.useState(!1),[m,A]=n.useState([]),[F,J]=n.useState(null),{data:H,isLoading:$e}=E({queryKey:["/api/game/leaderboard"],queryFn:()=>B("/api/game/leaderboard?limit=10")}),{data:oe,isLoading:Ya}=E({queryKey:["/api/game/scenarios",r==null?void 0:r.techLevel],queryFn:()=>B(`/api/game/scenarios?techLevel=${(r==null?void 0:r.techLevel)||"beginner"}`),enabled:!!r}),{data:Q}=E({queryKey:["/api/game/settings"],queryFn:()=>B("/api/game/settings")}),We=Y({mutationFn:c=>B("/api/game/login",{method:"POST",data:c}),onSuccess:c=>{i(c),o(!0),s({title:"Login successful",description:`Welcome back, ${c.username}!`})},onError:c=>{s({title:"Login failed",description:"Invalid username or password",variant:"destructive"})}}),Xe=Y({mutationFn:c=>B("/api/game/register",{method:"POST",data:c}),onSuccess:c=>{i(c),o(!0),s({title:"Registration successful",description:`Welcome to Asset Boardroom League, ${c.username}!`})},onError:c=>{s({title:"Registration failed",description:"Username may already be taken",variant:"destructive"})}}),Le=Y({mutationFn:c=>B("/api/game/sessions",{method:"POST",data:c}),onSuccess:c=>{f(c),S(0),g(!1),T(!1),A([]),P((Q==null?void 0:Q.timeLimit)||60),J(new Date)}}),it=Y({mutationFn:c=>B("/api/game/responses",{method:"POST",data:c}),onSuccess:c=>{A([...m,c]),g(!0)}}),ot=Y({mutationFn:c=>B(`/api/game/sessions/${y==null?void 0:y.id}/complete`,{method:"POST",data:c}),onSuccess:c=>{T(!0),_e.invalidateQueries({queryKey:["/api/game/leaderboard"]}),s({title:"Game completed!",description:`You scored ${c.totalScore} points!`})}}),ct=(c,v)=>{We.mutate({username:c,password:v})},dt=(c,v,x)=>{Xe.mutate({username:c,password:v,avatar:x})},Ze=()=>{if(!r||!oe)return;const c=oe.filter(C=>C.techLevel===r.techLevel),v=(Q==null?void 0:Q.scenariosPerGame)||5,x=c.length<=v?c:xt(c).slice(0,v);Le.mutate({playerId:r.id,techLevel:r.techLevel,scenariosPlayed:JSON.stringify(x.map(C=>C.id))})},es=c=>{if(!y||!p||!r)return;N(c);const x=JSON.parse(p.scores)[c]||0;let C=null;F&&(C=Math.floor((new Date().getTime()-F.getTime())/1e3)),it.mutate({sessionId:y.id,scenarioId:p.id,playerId:r.id,selectedOption:c,pointsEarned:x,responseTime:C})},mt=()=>{if(!y)return;const c=JSON.parse(y.scenariosPlayed);if(l<c.length-1)S(l+1),N(null),g(!1),P((Q==null?void 0:Q.timeLimit)||60),J(new Date);else{const v=m.reduce((x,C)=>x+C.pointsEarned,0);ot.mutate({totalScore:v})}};n.useEffect(()=>{if(!y)return;const c=JSON.parse(y.scenariosPlayed);if(c.length>l){const v=c[l];if(oe){const x=oe.find(C=>C.id===v);if(x){h(x);return}}B(`/api/game/scenarios/${v}`).then(x=>{h(x)}).catch(x=>{console.error("Error fetching scenario:",x),s({title:"Error",description:"Failed to load scenario",variant:"destructive"})})}},[l,y,oe]),n.useEffect(()=>{if(!y||k||!F)return;const c=setInterval(()=>{P(v=>{if(v<=1){if(clearInterval(c),!k&&p){const x=JSON.parse(p.scores),C=x.indexOf(Math.min(...x));es(C)}return 0}return v-1})},1e3);return()=>clearInterval(c)},[y,k,F,p]);const xt=c=>{const v=[...c];for(let x=v.length-1;x>0;x--){const C=Math.floor(Math.random()*(x+1));[v[x],v[C]]=[v[C],v[x]]}return v},ut=()=>{const[c,v]=n.useState("login"),[x,C]=n.useState(""),[W,je]=n.useState(""),[fe,jt]=n.useState(""),gt=["","","","","","","","","","","",""];return e.jsxs(R,{className:"w-full max-w-md mx-auto",children:[e.jsxs($,{children:[e.jsx(O,{className:"text-2xl font-bold text-center bg-gradient-to-r from-blue-600 to-indigo-600 text-transparent bg-clip-text",children:"Asset Boardroom League"}),e.jsx(Z,{className:"text-center",children:c==="login"?"Sign in to your account":"Create a new account"})]}),e.jsx(D,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Username"}),e.jsx("input",{type:"text",value:x,onChange:ce=>C(ce.target.value),className:"w-full p-2 border rounded-md",placeholder:"Enter your username"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Password"}),e.jsx("input",{type:"password",value:W,onChange:ce=>je(ce.target.value),className:"w-full p-2 border rounded-md",placeholder:"Enter your password"})]}),c==="register"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Choose Avatar"}),e.jsx("div",{className:"grid grid-cols-6 gap-2",children:gt.map(ce=>e.jsx(w,{variant:fe===ce?"default":"outline",className:"text-2xl p-2 h-auto",onClick:()=>jt(ce),children:ce},ce))})]})]})}),e.jsxs(Ue,{className:"flex flex-col space-y-2",children:[e.jsxs(w,{className:"w-full",onClick:()=>{c==="login"?ct(x,W):dt(x,W,fe)},disabled:!x||!W||c==="register"&&!fe,children:[We.isPending||Xe.isPending?e.jsx(ve,{className:"mr-2 h-4 w-4 animate-spin"}):null,c==="login"?"Sign In":"Create Account"]}),e.jsx("div",{className:"text-center text-sm",children:c==="login"?e.jsxs("span",{children:["Don't have an account?"," ",e.jsx("button",{onClick:()=>v("register"),className:"text-blue-600 hover:underline",children:"Sign up"})]}):e.jsxs("span",{children:["Already have an account?"," ",e.jsx("button",{onClick:()=>v("login"),className:"text-blue-600 hover:underline",children:"Sign in"})]})})]})]})},pt=()=>{if(!y||!p)return e.jsxs(R,{className:"w-full max-w-4xl mx-auto",children:[e.jsxs($,{children:[e.jsx(O,{className:"text-2xl font-bold text-center",children:"Start a New Game"}),e.jsx(Z,{className:"text-center",children:"Test your financial decision-making skills"})]}),e.jsx(D,{className:"text-center",children:e.jsxs(w,{size:"lg",onClick:Ze,disabled:Le.isPending,className:"mt-4",children:[Le.isPending?e.jsx(ve,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Start Game"]})})]});if(I){const v=m.reduce((x,C)=>x+C.pointsEarned,0);return e.jsxs(R,{className:"w-full max-w-4xl mx-auto",children:[e.jsxs($,{className:"text-center",children:[e.jsx(O,{className:"text-3xl font-bold bg-gradient-to-r from-amber-500 to-orange-500 text-transparent bg-clip-text",children:"Game Completed!"}),e.jsx(Z,{children:"Here's your performance summary"})]}),e.jsxs(D,{className:"space-y-6",children:[e.jsxs("div",{className:"text-center py-6",children:[e.jsxs("div",{className:"text-5xl font-bold mb-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-transparent bg-clip-text",children:[v," Points"]}),e.jsx("p",{className:"text-gray-500",children:"Total Score"})]}),e.jsx(ze,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Responses Breakdown"}),m.map((x,C)=>(oe==null||oe.find(W=>W.id===x.scenarioId),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium",children:["Question ",C+1]}),e.jsx("div",{className:"text-sm text-gray-500",children:x.responseTime?`${x.responseTime}s response time`:"No time recorded"})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(Ee,{variant:x.pointsEarned>0?"default":"destructive",children:[x.pointsEarned," pts"]})})]},C)))]}),e.jsx(w,{className:"w-full mt-6",onClick:Ze,disabled:Le.isPending,children:"Play Again"})]})]})}const c=JSON.parse(p.options);return e.jsxs(R,{className:"w-full max-w-4xl mx-auto",children:[e.jsxs($,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx(Ee,{variant:"outline",children:p.category.toUpperCase()}),e.jsxs(Ee,{variant:"outline",children:[l+1," of ",JSON.parse(y.scenariosPlayed).length]})]}),e.jsx(O,{className:"text-xl font-bold mb-2",children:p.question})]}),e.jsxs(D,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Time Remaining"}),e.jsxs("span",{className:"text-sm font-semibold flex items-center",children:[e.jsx(Kt,{className:"w-4 h-4 mr-1"})," ",j,"s"]})]}),e.jsx(at,{value:j/((Q==null?void 0:Q.timeLimit)||60)*100})]}),e.jsx("div",{className:"space-y-3",children:c.map((v,x)=>{const C=b===x,W=k?JSON.parse(p.scores):null,je=W?W[x]:null;let fe="outline";return k&&(C?fe=je>0?"default":"destructive":je&&je>0&&(fe="secondary")),e.jsxs(w,{variant:fe,className:`w-full justify-start text-left p-4 h-auto ${k?"cursor-default":"hover:bg-gray-100"} ${C?"ring-2 ring-blue-500":""}`,onClick:()=>!k&&es(x),disabled:k,children:[e.jsx("span",{className:"text-md",children:v}),k&&e.jsxs("span",{className:"ml-auto font-semibold",children:[je," points"]})]},x)})}),k&&e.jsxs(rt,{children:[e.jsx(nt,{className:"text-lg font-semibold",children:"Explanation"}),e.jsx(lt,{className:"mt-2",children:p.explanation})]})]}),e.jsx(Ue,{className:"flex justify-end",children:k&&e.jsx(w,{onClick:mt,children:l<JSON.parse(y.scenariosPlayed).length-1?"Next Question":"Finish Game"})})]})},ht=()=>e.jsxs(R,{className:"w-full max-w-4xl mx-auto",children:[e.jsxs($,{children:[e.jsxs(O,{className:"text-2xl font-bold flex items-center",children:[e.jsx(Es,{className:"mr-2 h-6 w-6 text-amber-500"}),"Leaderboard"]}),e.jsx(Z,{children:"Top performing financial strategists"})]}),e.jsx(D,{children:$e?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(ve,{className:"h-8 w-8 animate-spin text-gray-400"})}):e.jsxs("div",{className:"space-y-2",children:[H==null?void 0:H.map((c,v)=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg ${v<3?"bg-amber-50 border border-amber-200":"border"}`,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-8 h-8 flex items-center justify-center font-bold rounded-full ${v===0?"bg-amber-500 text-white":v===1?"bg-gray-300 text-gray-800":v===2?"bg-amber-700 text-white":"bg-gray-100 text-gray-800"}`,children:c.rank}),e.jsx(qe,{children:e.jsx(Ve,{children:c.avatar})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:c.username}),e.jsx("div",{className:"text-sm text-gray-500",children:c.techLevel.charAt(0).toUpperCase()+c.techLevel.slice(1)})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-bold",children:c.totalPoints}),e.jsxs("div",{className:"text-sm text-gray-500",children:[c.gamesPlayed," games"]})]})]},c.id)),((H==null?void 0:H.length)||0)===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No leaderboard data yet. Be the first to play!"})]})})]}),ft=()=>{var c,v;return r?e.jsxs(R,{className:"w-full max-w-4xl mx-auto",children:[e.jsx($,{children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(qe,{className:"h-16 w-16",children:e.jsx(Ve,{className:"text-2xl",children:r.avatar})}),e.jsxs("div",{children:[e.jsx(O,{className:"text-2xl font-bold",children:r.username}),e.jsxs(Z,{children:[r.techLevel.charAt(0).toUpperCase()+r.techLevel.slice(1)," Investor"]})]})]})}),e.jsxs(D,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:r.totalPoints}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Points"})]}),e.jsx("div",{className:"p-4 border rounded-lg",children:$e?e.jsx(ve,{className:"h-6 w-6 mx-auto animate-spin text-gray-400"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-3xl font-bold text-purple-600",children:((c=H==null?void 0:H.find(x=>x.playerId===r.id))==null?void 0:c.rank)||"-"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Rank"})]})}),e.jsx("div",{className:"p-4 border rounded-lg",children:$e?e.jsx(ve,{className:"h-6 w-6 mx-auto animate-spin text-gray-400"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:((v=H==null?void 0:H.find(x=>x.playerId===r.id))==null?void 0:v.gamesPlayed)||0}),e.jsx("div",{className:"text-sm text-gray-500",children:"Games Played"})]})})]}),e.jsx(ze,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold",children:"Settings"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Difficulty Level"}),e.jsxs("select",{className:"w-full p-2 border rounded-md",value:r.techLevel,onChange:x=>{const C=x.target.value;B(`/api/game/players/${r.id}`,{method:"PUT",data:{techLevel:C}}).then(W=>{i({...r,techLevel:C}),s({title:"Settings updated",description:"Your difficulty level has been updated"}),_e.invalidateQueries({queryKey:["/api/game/scenarios",C]})}).catch(W=>{s({title:"Error",description:"Failed to update settings",variant:"destructive"})})},children:[e.jsx("option",{value:"beginner",children:"Beginner"}),e.jsx("option",{value:"intermediate",children:"Intermediate"}),e.jsx("option",{value:"advanced",children:"Advanced"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Avatar"}),e.jsx("div",{className:"grid grid-cols-6 gap-2",children:["","","","","","","","","","","",""].map(x=>e.jsx(w,{variant:r.avatar===x?"default":"outline",className:"text-2xl p-2 h-auto",onClick:()=>{B(`/api/game/players/${r.id}`,{method:"PUT",data:{avatar:x}}).then(C=>{i({...r,avatar:x}),s({title:"Avatar updated",description:"Your avatar has been updated"})}).catch(C=>{s({title:"Error",description:"Failed to update avatar",variant:"destructive"})})},children:x},x))})]})]}),e.jsx(w,{variant:"outline",className:"w-full",onClick:()=>{o(!1),i(null),f(null),T(!1),s({title:"Logged out",description:"You have been logged out"})},children:"Logout"})]})]}):null};return e.jsxs("div",{className:"container py-8 px-4 mx-auto max-w-6xl",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 text-transparent bg-clip-text mb-2",children:"Asset Boardroom League"}),e.jsx("p",{className:"text-gray-600 max-w-lg mx-auto",children:"Test your strategic decision-making skills in corporate finance and risk management"})]}),u?e.jsx(e.Fragment,{children:e.jsx("div",{className:"mb-8",children:e.jsxs(Ae,{defaultValue:"play",value:a,className:"w-full",onValueChange:t,children:[e.jsxs(ye,{className:"grid w-full grid-cols-3",children:[e.jsxs(ee,{value:"play",className:"flex items-center",children:[e.jsx(Vt,{className:"mr-2 h-4 w-4"}),"Play"]}),e.jsxs(ee,{value:"leaderboard",className:"flex items-center",children:[e.jsx(zt,{className:"mr-2 h-4 w-4"}),"Leaderboard"]}),e.jsxs(ee,{value:"profile",className:"flex items-center",children:[e.jsx("div",{className:"mr-2",children:r==null?void 0:r.avatar}),"Profile"]})]}),e.jsx(se,{value:"play",className:"mt-4",children:pt()}),e.jsx(se,{value:"leaderboard",className:"mt-4",children:ht()}),e.jsx(se,{value:"profile",className:"mt-4",children:ft()})]})})}):ut()]})}function Ha(){return e.jsxs(bt,{children:[e.jsx(te,{path:"/",component:fa}),e.jsx(te,{path:"/proposals",component:Na}),e.jsx(te,{path:"/proposals/create",component:Da}),e.jsx(te,{path:"/proposals/:id",component:$a}),e.jsx(te,{path:"/proposals/edit/:id",component:Ea}),e.jsx(te,{path:"/templates",component:ba}),e.jsx(te,{path:"/backup",component:Ua}),e.jsx(te,{path:"/settings",component:Va}),e.jsx(te,{path:"/game",component:Ga}),e.jsx(te,{component:ia})]})}function Qa(){return e.jsx(vt,{client:_e,children:e.jsxs(na,{children:[e.jsx(ra,{}),e.jsx(Ha,{})]})})}Nt.createRoot(document.getElementById("root")).render(e.jsx(Qa,{}));
